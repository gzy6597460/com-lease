<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>layui</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="__PUBLIC__/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="__PUBLIC__/font-awesome/css/font-awesome.min.css" media="all"/>
    <link rel="stylesheet" href="__CSS__/admin.css" media="all">
    <style type="text/css">

        /* tooltip */
        #tooltip {
            position: absolute;
            border: 1px solid #ccc;
            background: #333;
            padding: 2px;
            display: none;
            color: #fff;
        }
    </style>
</head>
<body style="padding:10px;">
<div class="tplay-body-div">

    <!--<form class="layui-form serch" action="{:url('admin/order/index')}" method="post">-->
    <!--<div class="layui-form-item" style="float: left;">-->
    <!--<div class="layui-input-inline">-->
    <!--<input type="text" name="keywords" lay-verify="title" autocomplete="off" placeholder="请输入关键词"-->
    <!--class="layui-input layui-btn-sm">-->
    <!--</div>-->

    <!--<div class="layui-input-inline">-->
    <!--<div class="layui-inline">-->
    <!--<select name="admin_id" lay-search="">-->
    <!--<option value="">创建人</option>-->

    <!--</select>-->
    <!--</div>-->
    <!--</div>-->
    <!--<div class="layui-input-inline">-->
    <!--<div class="layui-inline">-->
    <!--<div class="layui-input-inline">-->
    <!--<input type="text" class="layui-input" id="create_time" placeholder="创建时间" name="create_time">-->
    <!--</div>-->
    <!--</div>-->
    <!--</div>-->
    <!--<button class="layui-btn layui-btn-danger layui-btn-sm" lay-submit="" lay-filter="serch">立即提交</button>-->
    <!--</div>-->
    <!--</form>-->

    <form class="layui-form layui-form-pane" action="{:url()}" method="post">
        <div class="layui-form-item">
            <input type="hidden" name="id" autocomplete="off" placeholder="订单id" class="layui-input layui-bg-gray"
                   value="{$data_info.id}">
            <label class="layui-form-label">订单号</label>
            <div class="layui-input-inline">
                <input type="text" readonly="readonly" name="out_trade_no" autocomplete="off" placeholder="订单号"
                       class="layui-input layui-bg-gray" value="{$data_info.out_trade_no}">
            </div>
            <label class="layui-form-label">订单状态</label>
            <div class="layui-input-inline">
                <select name="status" lay-filter="status">
                    <option value="{$data_info.status}">{$data_info.status}</option>
                    <option value="未付款">未付款</option>
                    <option value="已付款，待发货">已付款，待发货</option>
                    <option value="已发货">已发货</option>
                    <option value="租赁中">租赁中</option>
                    <option value="租赁结束">租赁结束</option>
                    <option value="关闭订单">关闭订单</option>
                    <option value="更换设备">更换设备</option>
                    <option value="归还设备中">归还设备中</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">收货人</label>
            <div class="layui-input-inline">
                <input type="text" name="buy_name" lay-verify="required" placeholder="收货人" autocomplete="off"
                       class="layui-input " value="{$data_info.buy_name}">
            </div>
            <label class="layui-form-label">收货人电话</label>
            <div class="layui-input-inline">
                <input type="text" name="phone" lay-verify="required" placeholder="收货人电话" autocomplete="off"
                       class="layui-input " value="{$data_info.phone}">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">收货地址</label>
            <div class="layui-input-block">
                <input type="text" name="address" lay-verify="required" placeholder="收货地址" autocomplete="off"
                       class="layui-input " value="{$data_info.address}">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">商品名称</label>
            <div class="layui-input-inline">
                <input type="text" name="goods.goods_name" lay-verify="required" placeholder="收货人" autocomplete="off"
                       class="layui-input layui-bg-gray" value="{$data_info.goods.goods_name}" readonly="readonly">
            </div>
            <label class="layui-form-label">租赁数量</label>
            <div class="layui-input-inline">
                <input type="text" name="buy_num" lay-verify="required" placeholder="收货人电话" autocomplete="off"
                       class="layui-input " value="{$data_info.buy_num}">
            </div>
        </div>
        <div class="layui-form-item" pane="">
            <label class="layui-form-label">租赁月数</label>
            <div class="layui-input-inline">
                <input type="radio" name="lease_months" value="3" title="3个月" {if
                       condition="$data_info.lease_months == 3" } checked {/if}>
                <input type="radio" name="lease_months" value="6" title="6个月" {if
                       condition="$data_info.lease_months == 6" } checked {/if}>
                <input type="radio" name="lease_months" value="12" title="12个月" {if
                       condition="$data_info.lease_months == 12" } checked {/if}>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">订单金额</label>
            <div class="layui-input-inline">
                <input type="text" name="total_fee" lay-verify="required" placeholder="￥" autocomplete="off"
                       class="layui-input " value="{$data_info.total_fee/100}">
            </div>
            <label class="layui-form-label">实际支付</label>
            <div class="layui-input-inline">
                <input type="text" name="real_pay" lay-verify="required" placeholder="实际支付" autocomplete="off"
                       class="layui-input layui-bg-gray" value="￥{$data_info.real_pay/100}" disabled="disabled">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">抵扣积分</label>
            <div class="layui-input-inline">
                <input type="text" name="deduction_score" lay-verify="required" placeholder="实际支付" autocomplete="off"
                       class="layui-input " value="{$data_info.deduction_score}">
            </div>
            <label class="layui-form-label">下单时间</label>
            <div class="layui-input-inline">
                <input type="text" name="create_time" placeholder="下单时间" autocomplete="off"
                       class="layui-input layui-bg-gray" value="{$data_info.create_time}" disabled="disabled">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">微信支付单号</label>
            <div class="layui-input-block">
                <input type="text" name="transaction_id" placeholder="微信支付单号" autocomplete="off"
                       class="layui-input layui-bg-gray" value="{$data_info.transaction_id}" disabled="disabled">
            </div>

        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">支付状态</label>
            <div class="layui-input-inline">
                <input type="text" name="trade_state_desc" placeholder="支付状态" autocomplete="off"
                       class="layui-input layui-bg-gray" value="{$data_info.trade_state_desc}" disabled="disabled">
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">开始时间</label>
                <div class="layui-input-block">
                    <input type="text" name="start_time" id="date1" placeholder="请选择开始时间" autocomplete="off"
                           class="layui-input"
                           value="{$data_info.start_time}">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">结束时间</label>
                <div class="layui-input-block">
                    <input type="text" name="end_time" id="date2" placeholder="可不填,自动计算" autocomplete="off"
                           class="layui-input"
                           value="{$data_info.end_time}">
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">赠送积分</label>
            <div class="layui-input-inline">
                <input type="text" name="extra_score" lay-verify="required" placeholder="订单赠送积分" autocomplete="off"
                       class="layui-input " value="{$data_info.extra_score}">
            </div>
            <label class="layui-form-label">快递单号</label>
            <div class="layui-input-inline">
                <input type="text" name="express_num" placeholder="快递单号" autocomplete="off" class="layui-input"
                       value="{$data_info.express.express_num}">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">发货方式</label>
            <div class="layui-input-inline">
                <input type="text" name="express_channel" placeholder="发货方式" autocomplete="off"
                       class="layui-input " value="{$data_info.express.express_channel}">
            </div>
            <label class="layui-form-label">发货时间</label>
            <div class="layui-input-inline">
                <input type="text" name="express_date" id="date3" autocomplete="off" class="layui-input"
                       value="{$data_info.express.express_date}">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">收货时间</label>
            <div class="layui-input-inline">
                <input type="text" name="confirm_date" id="date4" placeholder="请选择收货时间" autocomplete="off"
                       class="layui-input"
                       value="{$data_info.express.confirm_date}">
            </div>
        </div>
        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">备注</label>
            <div class="layui-input-block">
                <textarea name="remark" placeholder="请输入内容" class="layui-textarea">{$data_info.remark}</textarea>
            </div>
        </div>
        <div class="layui-form-item">
            <button class="layui-btn" lay-submit="" lay-filter="demo2">修改提交</button>
        </div>
    </form>
    {include file="public/foot"}
    <script>
        layui.use(['form', 'layedit', 'laydate'], function () {
            var form = layui.form
                , layer = layui.layer
                , layedit = layui.layedit
                , laydate = layui.laydate;

            //监听提交
            form.on('submit(demo2)', function(data){
                //layer.msg(JSON.stringify(data.field));

                $.ajax({
                    type: 'POST',
                    dataType:'json',
                    data: data.field,
                    url:"{:url()}",
                    success:function(data){
                        if(data.success == true){
                            layer.msg(data.message);
                            var index = parent.layer.getFrameIndex(window.name);
                            setTimeout(function(){
                                parent.layer.close(index);//关闭弹出层
                                parent.location.reload();//更新父级页面（提示：如果需要跳转到其它页面见下文）
                            }, 2000);
                        }else if(data.success == false){
                            layer.msg(data.message,{
                                anim:6
                            });
                        }else{
                            layer.msg('请求异常',{
                                anim:6
                            });
                        }
                        layer.closeAll('iframe');//关闭弹窗
                    }
                });
                return false;
            });

            var ins22 = laydate.render({
                elem: '#date1'
                , min: '2018-01-01'
                , max: '2099-01-01'
                , ready: function () {
                    ins22.hint('日期可选值设定在 <br> 2018-01-01 到 2099-01-01');
                }
            });
            laydate.render({
                elem: '#date2'
            });
            laydate.render({
                elem: '#date3'
                , type: 'datetime'
                , min: '2018-01-01 00:00:00'
                , max: '2099-01-01 00:00:00'
            });
            laydate.render({
                elem: '#date4'
                , type: 'datetime'
                , min: '2018-01-01 00:00:00'
                , max: '2099-01-01 00:00:00'
            });
            laydate.render({
                elem: '#date5'
            });
        });
    </script>
</div>
</body>
</html>
